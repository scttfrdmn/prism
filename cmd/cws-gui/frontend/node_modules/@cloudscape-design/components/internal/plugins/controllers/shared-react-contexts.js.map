{"version":3,"file":"shared-react-contexts.js","sourceRoot":"","sources":["../../../../../src/internal/plugins/controllers/shared-react-contexts.ts"],"names":[],"mappings":";;AAQA,MAAM,OAAO,mBAAmB;IAAhC;QACE,kDAAsB,IAAI,OAAO,EAAiD,EAAC;QAEnF,kBAAa,GAAG,CAAI,aAA2B,EAAE,WAAmB,EAAE,EAAE;YACtE,IAAI,QAAQ,GAAG,uBAAA,IAAI,+CAAoB,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;YAC3D,IAAI,CAAC,QAAQ,EAAE;gBACb,QAAQ,GAAG,IAAI,GAAG,EAAE,CAAC;gBACrB,uBAAA,IAAI,+CAAoB,CAAC,GAAG,CAAC,aAAa,EAAE,QAAQ,CAAC,CAAC;aACvD;YAED,IAAI,aAAa,GAAG,QAAQ,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;YAE9C,IAAI,CAAC,aAAa,EAAE;gBAClB,aAAa,GAAG,aAAa,CAAC,aAAa,CAAI,SAAc,CAAC,CAAC;gBAC/D,QAAQ,CAAC,GAAG,CAAC,WAAW,EAAE,aAAa,CAAC,CAAC;aAC1C;YAED,OAAO,aAAa,CAAC;QACvB,CAAC,CAAC;IAMJ,CAAC;IAJC,eAAe,CAAC,cAAuD,EAAE;;QACvE,MAAA,WAAW,CAAC,aAAa,oCAAzB,WAAW,CAAC,aAAa,GAAK,IAAI,CAAC,aAAa,EAAC;QACjD,OAAO,WAA6C,CAAC;IACvD,CAAC;CACF","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React from 'react';\n\nexport interface SharedReactContextsApiInternal {\n  createContext: <T>(ReactInstance: typeof React, contextName: string) => React.Context<T | undefined>;\n}\n\nexport class SharedReactContexts {\n  #registeredContexts = new WeakMap<typeof React, Map<string, React.Context<any>>>();\n\n  createContext = <T>(ReactInstance: typeof React, contextName: string) => {\n    let contexts = this.#registeredContexts.get(ReactInstance);\n    if (!contexts) {\n      contexts = new Map();\n      this.#registeredContexts.set(ReactInstance, contexts);\n    }\n\n    let cachedContext = contexts.get(contextName);\n\n    if (!cachedContext) {\n      cachedContext = ReactInstance.createContext<T>(undefined as T);\n      contexts.set(contextName, cachedContext);\n    }\n\n    return cachedContext;\n  };\n\n  installInternal(internalApi: Partial<SharedReactContextsApiInternal> = {}): SharedReactContextsApiInternal {\n    internalApi.createContext ??= this.createContext;\n    return internalApi as SharedReactContextsApiInternal;\n  }\n}\n"]}