{"version":3,"file":"internal.js","sourceRoot":"","sources":["../../../src/input/internal.tsx"],"names":[],"mappings":"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","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { Ref, useRef } from 'react';\nimport clsx from 'clsx';\n\nimport { useMergeRefs } from '@cloudscape-design/component-toolkit/internal';\nimport {\n  copyAnalyticsMetadataAttribute,\n  getAnalyticsMetadataAttribute,\n} from '@cloudscape-design/component-toolkit/internal/analytics-metadata';\n\nimport InternalButton from '../button/internal';\nimport { useInternalI18n } from '../i18n/context';\nimport { IconProps } from '../icon/interfaces';\nimport InternalIcon from '../icon/internal';\nimport { BaseComponentProps, getBaseProps } from '../internal/base-component';\nimport { FormFieldValidationControlProps, useFormFieldContext } from '../internal/context/form-field-context';\nimport { fireKeyboardEvent, fireNonCancelableEvent, NonCancelableEventHandler } from '../internal/events';\nimport { InternalBaseComponentProps } from '../internal/hooks/use-base-component';\nimport { useDebounceCallback } from '../internal/hooks/use-debounce-callback';\nimport WithNativeAttributes, { SkipWarnings } from '../internal/utils/with-native-attributes';\nimport {\n  GeneratedAnalyticsMetadataInputClearInput,\n  GeneratedAnalyticsMetadataInputComponent,\n} from './analytics-metadata/interfaces';\nimport { BaseChangeDetail, BaseInputProps, InputAutoCorrect, InputProps } from './interfaces';\nimport { convertAutoComplete, useSearchProps } from './utils';\n\nimport styles from './styles.css.js';\n\nexport interface InternalInputProps\n  extends BaseComponentProps,\n    BaseInputProps,\n    Omit<InputProps, 'type'>,\n    InputAutoCorrect,\n    FormFieldValidationControlProps,\n    InternalBaseComponentProps {\n  type?: InputProps['type'] | 'visualSearch';\n  __leftIcon?: IconProps['name'];\n  __leftIconVariant?: IconProps['variant'];\n  __onLeftIconClick?: () => void;\n\n  __rightIcon?: IconProps['name'];\n  __onRightIconClick?: () => void;\n\n  __noBorderRadius?: boolean;\n\n  __onDelayedInput?: NonCancelableEventHandler<BaseChangeDetail>;\n  __onBlurWithDetail?: NonCancelableEventHandler<{ relatedTarget: Node | null }>;\n\n  __inheritFormFieldProps?: boolean;\n  __injectAnalyticsComponentMetadata?: boolean;\n  __skipNativeAttributesWarnings?: SkipWarnings;\n}\n\nfunction InternalInput(\n  {\n    type = 'text',\n    step,\n    inputMode,\n    autoComplete = true,\n    ariaLabel,\n    clearAriaLabel: clearAriaLabelOverride,\n    name,\n    value,\n    placeholder,\n    autoFocus,\n    disabled,\n    readOnly,\n    disableBrowserAutocorrect,\n    spellcheck,\n    __noBorderRadius,\n\n    __leftIcon,\n    __leftIconVariant = 'subtle',\n    __onLeftIconClick,\n\n    ariaRequired,\n\n    __rightIcon,\n    __onRightIconClick,\n\n    onKeyDown,\n    onKeyUp,\n    onChange,\n    __onDelayedInput,\n    __onBlurWithDetail,\n    onBlur,\n    onFocus,\n    nativeInputAttributes,\n    __internalRootRef,\n    __inheritFormFieldProps,\n    __injectAnalyticsComponentMetadata,\n    __skipNativeAttributesWarnings,\n    ...rest\n  }: InternalInputProps,\n  ref: Ref<HTMLInputElement>\n) {\n  const baseProps = getBaseProps(rest);\n  const i18n = useInternalI18n('input');\n  const fireDelayedInput = useDebounceCallback((value: string) => fireNonCancelableEvent(__onDelayedInput, { value }));\n\n  const handleChange = (value: string) => {\n    fireDelayedInput(value);\n    fireNonCancelableEvent(onChange, { value });\n  };\n\n  const inputRef = useRef<HTMLInputElement>(null);\n  const searchProps = useSearchProps(type, disabled, readOnly, value, inputRef, handleChange);\n  __leftIcon = __leftIcon ?? searchProps.__leftIcon;\n  __rightIcon = __rightIcon ?? searchProps.__rightIcon;\n  __onRightIconClick = __onRightIconClick ?? searchProps.__onRightIconClick;\n\n  const formFieldContext = useFormFieldContext(rest);\n  const { ariaLabelledby, ariaDescribedby, controlId, invalid, warning } = __inheritFormFieldProps\n    ? formFieldContext\n    : rest;\n\n  const attributes: React.InputHTMLAttributes<HTMLInputElement> = {\n    'aria-label': ariaLabel,\n    // aria-labelledby has precedence over aria-label in accessible name calculation.\n    // When aria-label is provided for Input, it should override aria-labelledBy from form-field context.\n    // If both aria-label and aria-labelledby come from Input props, aria-labelledby will be used in accessible name\n    'aria-labelledby': ariaLabel && !rest.ariaLabelledby ? undefined : ariaLabelledby,\n    'aria-describedby': ariaDescribedby,\n    name,\n    placeholder,\n    autoFocus,\n    id: controlId,\n    className: clsx(\n      styles.input,\n      type && styles[`input-type-${type}`],\n      __rightIcon && styles['input-has-icon-right'],\n      __leftIcon && styles['input-has-icon-left'],\n      __noBorderRadius && styles['input-has-no-border-radius'],\n      {\n        [styles['input-readonly']]: readOnly,\n        [styles['input-invalid']]: invalid,\n        [styles['input-warning']]: warning && !invalid,\n      }\n    ),\n    autoComplete: convertAutoComplete(autoComplete),\n    disabled,\n    readOnly,\n    type,\n    step,\n    inputMode,\n    spellCheck: spellcheck,\n    onKeyDown: onKeyDown && (event => fireKeyboardEvent(onKeyDown, event)),\n    onKeyUp: onKeyUp && (event => fireKeyboardEvent(onKeyUp, event)),\n    // We set a default value on the component in order to force it into the controlled mode.\n    value: value ?? '',\n    onChange: onChange && (event => handleChange(event.target.value)),\n    onBlur: e => {\n      fireNonCancelableEvent(onBlur);\n      fireNonCancelableEvent(__onBlurWithDetail, { relatedTarget: e.relatedTarget });\n    },\n    onFocus: onFocus && (() => fireNonCancelableEvent(onFocus)),\n  };\n\n  if (type === 'number') {\n    // Chrome and Safari have a weird built-in behavior of letting focused\n    // number inputs be controlled by scrolling on them. However, they don't\n    // lock the browser's scroll, so it's very easy to accidentally increment\n    // the input while scrolling down the page.\n    attributes.onWheel = event => event.currentTarget.blur();\n  }\n\n  if (disableBrowserAutocorrect) {\n    attributes.autoCorrect = 'off';\n    attributes.autoCapitalize = 'off';\n  }\n\n  // ensure aria properties are string literal \"true\"\n  if (ariaRequired) {\n    attributes['aria-required'] = 'true';\n  }\n  if (invalid) {\n    attributes['aria-invalid'] = 'true';\n  }\n\n  const mergedRef = useMergeRefs(ref, inputRef);\n\n  // type = \"visualSearch\" renders a type=\"text' input\n  if (attributes.type === 'visualSearch') {\n    attributes.type = 'text';\n  }\n\n  const componentAnalyticsMetadata: GeneratedAnalyticsMetadataInputComponent = {\n    name: 'awsui.Input',\n    label: 'input',\n    properties: {\n      value: value || '',\n    },\n  };\n\n  return (\n    <div\n      {...baseProps}\n      className={clsx(baseProps.className, styles['input-container'])}\n      ref={__internalRootRef}\n      dir={type === 'email' ? 'ltr' : undefined}\n      {...(__injectAnalyticsComponentMetadata\n        ? getAnalyticsMetadataAttribute({ component: componentAnalyticsMetadata })\n        : copyAnalyticsMetadataAttribute(rest))}\n    >\n      {__leftIcon && (\n        <span onClick={__onLeftIconClick} className={styles['input-icon-left']}>\n          <InternalIcon name={__leftIcon} variant={disabled || readOnly ? 'disabled' : __leftIconVariant} />\n        </span>\n      )}\n      <WithNativeAttributes\n        {...attributes}\n        tag=\"input\"\n        componentName=\"Input\"\n        nativeAttributes={nativeInputAttributes}\n        skipWarnings={__skipNativeAttributesWarnings}\n        ref={mergedRef}\n      />\n      {__rightIcon && (\n        <span\n          className={styles['input-icon-right']}\n          {...(__rightIcon === 'close'\n            ? getAnalyticsMetadataAttribute({\n                action: 'clearInput',\n              } as Partial<GeneratedAnalyticsMetadataInputClearInput>)\n            : {})}\n        >\n          <InternalButton\n            // Used for test utils\n            className={styles['input-button-right']}\n            variant=\"inline-icon-pointer-target\"\n            formAction=\"none\"\n            iconName={__rightIcon}\n            onClick={__onRightIconClick}\n            ariaLabel={i18n('clearAriaLabel', clearAriaLabelOverride)}\n            disabled={disabled}\n          />\n        </span>\n      )}\n    </div>\n  );\n}\n\nexport default React.forwardRef(InternalInput);\n"]}