name: "Enterprise Server (DNF)"
description: "Ubuntu environment configured with DNF for enterprise server development and testing"
base: "ubuntu-22.04"

# Use DNF package manager
package_manager: "dnf"

packages:
  system:  # Enterprise packages (APT equivalent)
    - "build-essential"
    - "curl"
    - "wget"
    - "git"
    - "vim"
    - "nano"
    - "htop"
    - "tree"
    - "unzip"
    - "software-properties-common"
    - "openssl"
    - "ca-certificates"
    # Container runtime
    - "docker.io"
    - "docker-compose"
    # Enterprise tools  
    - "rsyslog"
    - "chrony"
    - "ufw"
    # Development tools
    - "nodejs"
    - "npm"
    - "python3"
    - "python3-pip"
    - "openjdk-17-jdk"

users:
  - name: "admin"
    password: "auto-generated"
    groups: ["wheel", "docker"]

services:
  - name: "docker"
    enable: true
  - name: "chrony"
    enable: true
  - name: "rsyslog"
    enable: true

# Post-install script for enterprise setup
post_install: |
  # Configure UFW firewall for basic services
  ufw allow ssh
  ufw allow http
  ufw allow https
  ufw --force enable
  
  # Set up time synchronization
  timedatectl set-ntp true
  
  # Configure Docker group
  usermod -aG docker admin
  
  # Set up enterprise logging
  echo "Setting up enterprise logging configuration..."
  echo "LogLevel INFO" >> /etc/ssh/sshd_config

instance_defaults:
  ports: [22, 80, 443, 8080]

version: "1.0"
tags:
  type: "enterprise"
  os: "rocky-linux"
  purpose: "server"
  security: "selinux"